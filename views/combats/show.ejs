<%- include('../partials/html-head') %>
  <%- include('../partials/nav') %>
    <%- include('../partials/sidebar') %>
      <main>
        <h1>
          <%= title %>
        </h1>
        <table class="sortable" id="combatSpecific">
          <thead>
            <tr>
              <th>Name</th>
              <th>Turn</th>
              <th>Max HP</th>
              <th>HP</th>
              <th>AC</th>
              <th>Roll Turn</th>
              <th>Take Damage</th>
            </tr>
          </thead>
          <tbody>
    <% combat.characters.sort((a,b) => b.initiative - a.initiative).forEach(char => { %>
      <tr>
      <td>
        <%= char.name %>
      </td>
      <td>
        <%= char.initiative %>
      </td>
      <td>
        <%= char.hitPoints %>
      </td>
      <td>
        <%= char.currentHP %>
      </td>
      <td>
        <%= char.armorClass %>
      </td>
      <td>
        <form id="initiative" action="/characters/<%= char._id %>/setInit?_method=PATCH" method="POST">
            <input id="initRoll" type="number" name="initiative">
          <button id="submitCombat" type="submit">Set</button>
          </form>
      </td>
      <td>
        <form id="damage" action="/characters/<%= char._id %>/takeDamage?_method=PATCH" method="POST">
            <input id="initRoll" type="number" name="currentHP">
          <button id="submitCombat" type="submit">Hit</button>
          </form>
      </td>
    </tr>
    <% }) %>
  </tbody>
</table>
        <form id="combatForm" action="/combats/<%= combat._id %>/characters" method="POST">
          <select class="form-select-lg mb-3" name="charId">
            <% characters.forEach(char => { %>
              <option value="<%= char._id %>"><%= char.name %></option>
            <% }) %>
          </select>
          </label><br>
          <button id="submitCombat" type="submit">Add to Combat</button>
        </form>
      </form>
      </main>
      <%- include('../partials/footer') %>